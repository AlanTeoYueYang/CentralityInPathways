ggplot(total, aes(y = freq, x= quant)) + geom_point()+
geom_smooth(method= "lm") +
facet_wrap(~Centrality ,ncol = 3) +theme_bw()+
theme(plot.title = element_text(size = 20),
axis.title = element_text(size = 20),
legend.text = element_text(size = 9),
legend.title=element_text(face = "bold", size = 9),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
ggplot(total, aes(y = freq, x= quant)) + geom_point()+
geom_smooth(method= "lm") +
facet_wrap(~Centrality ,ncol = 3) +theme_bw()+ labs(x = "Quantile", y = "Frequency")+
theme(plot.title = element_text(size = 20),
axis.title = element_text(size = 20),
legend.text = element_text(size = 9),
legend.title=element_text(face = "bold", size = 9),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
ggplot(total, aes(y = freq, x= quant)) + geom_point()+
geom_smooth(method= "lm") +
facet_wrap(~Centrality ,ncol = 3) +theme_bw()+ labs(x = "Quantile", y = "Frequency")+
theme(strip.text = element_text(face="bold", size=9),
plot.title = element_text(size = 20),
axis.title = element_text(size = 20),
legend.text = element_text(size = 9),
legend.title=element_text(face = "bold", size = 9),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
ggplot(total, aes(y = freq, x= quant)) + geom_point()+
geom_smooth(method= "lm") +
facet_wrap(~Centrality ,ncol = 3) +theme_bw()+ labs(x = "Quantile", y = "Frequency")+
theme(strip.text = element_text(face="bold", size=20),
plot.title = element_text(size = 20),
axis.title = element_text(size = 20),
legend.text = element_text(size = 9),
legend.title=element_text(face = "bold", size = 9),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
ggplot(total, aes(y = freq, x= quant)) + geom_point()+
geom_smooth(method= "lm") + geom_smooth(method= "loess") +
facet_wrap(~Centrality ,ncol = 3) +theme_bw()+ labs(x = "Quantile", y = "Frequency")+
theme(strip.text = element_text(face="bold", size=20),
plot.title = element_text(size = 20),
axis.title = element_text(size = 20),
legend.text = element_text(size = 9),
legend.title=element_text(face = "bold", size = 9),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
ggplot(total, aes(y = freq, x= quant)) + geom_point()+
geom_smooth(method= "lm") + geom_smooth(method= "loess", color="green") +
facet_wrap(~Centrality ,ncol = 3) +theme_bw()+ labs(x = "Quantile", y = "Frequency")+
theme(strip.text = element_text(face="bold", size=20),
plot.title = element_text(size = 20),
axis.title = element_text(size = 20),
legend.text = element_text(size = 9),
legend.title=element_text(face = "bold", size = 9),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
ggplot(total, aes(y = freq, x= quant)) + geom_point()+
geom_smooth(method= "lm") + geom_smooth(method= "loess", color="green" , fill = "red") +
facet_wrap(~Centrality ,ncol = 3) +theme_bw()+ labs(x = "Quantile", y = "Frequency")+
theme(strip.text = element_text(face="bold", size=20),
plot.title = element_text(size = 20),
axis.title = element_text(size = 20),
legend.text = element_text(size = 9),
legend.title=element_text(face = "bold", size = 9),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
ggplot(total, aes(y = freq, x= quant)) + geom_point()+
geom_smooth(method= "lm") + #geom_smooth(method= "loess", color="green" , fill = "red") +
facet_wrap(~Centrality ,ncol = 3) +theme_bw()+ labs(x = "Quantile", y = "Frequency")+
theme(strip.text = element_text(face="bold", size=20),
plot.title = element_text(size = 20),
axis.title = element_text(size = 20),
legend.text = element_text(size = 9),
legend.title=element_text(face = "bold", size = 9),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
ggplot(total, aes(y = freq, x= quant)) + geom_point()+
geom_smooth(method= "lm") + #geom_smooth(method= "loess", color="green" , fill = "red") +
facet_wrap(~Centrality ,ncol = 3) +theme_bw()+ labs(x = "Quantile", y = "Frequency")+
theme(strip.text = element_text(face="bold", size=20),
plot.title = element_text(size = 20),
axis.title = element_text(size = 20),
legend.text = element_text(size = 9),
legend.title=element_text(face = "bold", size = 9),
axis.text.y=element_text(size = 9),
axis.ticks.y=element_blank())
ggplot(total, aes(y = freq, x= quant)) + geom_point()+
geom_smooth(method= "lm") + #geom_smooth(method= "loess", color="green" , fill = "red") +
facet_wrap(~Centrality ,ncol = 3) +theme_bw()+ labs(x = "Quantile", y = "Frequency")+
theme(strip.text = element_text(face="bold", size=20),
plot.title = element_text(size = 20),
axis.title = element_text(size = 20),
legend.text = element_text(size = 9),
legend.title=element_text(face = "bold", size = 9),
axis.text.y=element_text(size = 15),
axis.ticks.y=element_blank())
ggplot(total, aes(y = freq, x= quant)) + geom_point()+
geom_smooth(method= "lm") + #geom_smooth(method= "loess", color="green" , fill = "red") +
facet_wrap(~Centrality ,ncol = 3) +theme_bw()+ labs(x = "Quantile", y = "Frequency")+
theme(strip.text = element_text(face="bold", size=20),
plot.title = element_text(size = 20),
axis.title = element_text(size = 20),
legend.text = element_text(size = 9),
legend.title=element_text(face = "bold", size = 9),
axis.text.y=element_text(size = 15),
axis.text.x=element_text(size = 15),
axis.ticks.y=element_blank())
ggplot(total, aes(y = freq, x= quant)) + geom_point()+
geom_smooth(method= "lm") + #geom_smooth(method= "loess", color="green" , fill = "red") +
facet_wrap(~Centrality ,ncol = 3) +theme_bw()+ labs(x = "Quantile", y = "Frequency")+
theme(strip.text = element_text(face="bold", size=20),
plot.title = element_text(size = 20),
axis.title = element_text(size = 30),
legend.text = element_text(size = 9),
legend.title=element_text(face = "bold", size = 9),
axis.text.y=element_text(size = 15),
axis.text.x=element_text(size = 15),
axis.ticks.y=element_blank())
ggplot(total, aes(y = freq, x= quant)) + geom_point()+
geom_smooth(method= "lm") + geom_smooth(method= "loess", color="green" , fill = "red") +
facet_wrap(~Centrality ,ncol = 3) +theme_bw()+ labs(x = "Quantile", y = "Frequency")+
theme(strip.text = element_text(face="bold", size=20),
plot.title = element_text(size = 20),
axis.title = element_text(size = 30),
legend.text = element_text(size = 9),
legend.title=element_text(face = "bold", size = 9),
axis.text.y=element_text(size = 15),
axis.text.x=element_text(size = 15),
axis.ticks.y=element_blank())
ggplot(gene.essential2,aes(pgr.quant2, color = Description)) +
stat_ecdf(geom = "point") + theme_bw()
zz3 <- cut2(gene.essential$pgr.und.norm,m = 3, g = 100)
zz3
zz3 <- cut2(gene.essential$pgr.und.norm,m = 3, g = 101)
zz3
zz3 <- cut2(gene.essential$pgr.und.norm,m = 3, g = 101)
levels(zz3) <- 1:100
gene.essential <-  mutate(gene.essential, pgr.quant3 = as.numeric(zz3))
gene.essential2 <- rbind(gene.essential, mutate(gene.essential, Description = "All genes"),
mutate(gene.essential, pgr.quant2 = pgr.quant3, Description = "All genes Undirected"))
ggplot(gene.essential2,aes(pgr.quant2, color = Description)) +
stat_ecdf(geom = "point") + theme_bw()
gene.essential <-  mutate(gene.essential, pgr.quant3 = as.numeric(zz3))
ggplot(gene.essential2,aes(pgr.quant2,pgr.quant3, color = Description)) +
stat_ecdf(geom = "point") + theme_bw()
gene.essential2 <- rbind(gene.essential, mutate(gene.essential, Description = "All genes"),
mutate(gene.essential, Description = "All genes"))
ggplot(gene.essential2,aes(pgr.quant2,pgr.quant3, color = Description)) +
stat_ecdf(geom = "point") + theme_bw()
ggplot(gene.essential2,aes(pgr.quant3, color = Description)) +
stat_ecdf(geom = "point") + theme_bw()
ggplot(gene.essential2,aes(pgr.quant2, color = Description)) +
stat_ecdf(geom = "point") + theme_bw()
gene.essential2 <- rbind(gene.essential, mutate(gene.essential, Description = "All genes"))
ggplot(gene.essential2,aes(pgr.quant2, color = Description)) +
stat_ecdf(geom = "point") + theme_bw()
ggplot(gene.essential2,aes(pgr.quant3, color = Description)) +
stat_ecdf(geom = "point") + theme_bw()
gene.essential3 <- mutate(gene.essential) %>% filter(.,Description = "Cancer")
gene.essential3 <- mutate(gene.essential) %>% filter(.,Description == "Cancer")
gene.essential4 <-mutate(gene.essential3, pgr.quant2 = pgr.quant3 , Description = "Undirected")
gene.essential4 <- rbind(gene.essential3, gene.essential4)
ggplot(gene.essential4,aes(pgr.quant4, color = Description)) +
stat_ecdf(geom = "point") + theme_bw()
ggplot(gene.essential4,aes(pgr.quant2, color = Description)) +
stat_ecdf(geom = "point") + theme_bw()
gene.essential3 <- mutate(gene.essential) %>% filter(.,Description == "Cancer") %>% mutate(., Description = "Source-Sink Cancer")
gene.essential4 <-mutate(gene.essential3, pgr.quant2 = pgr.quant3 , Description = "Undirected Cancer")
gene.essential4 <- rbind(gene.essential3, gene.essential4)
ggplot(gene.essential4,aes(pgr.quant2, color = Description)) +
stat_ecdf(geom = "point") + theme_bw()
ggplot(gene.essential4,aes(pgr.quant2, color = Description)) + geom_point(size = 2)
ggplot(gene.essential4,aes(pgr.quant2, color = Description,size = 2)) +
stat_ecdf(geom = "point") + theme_bw()
ggplot(gene.essential4,aes(pgr.quant2, color = Description,size = 1.5)) +
stat_ecdf(geom = "point") + theme_bw()
ggplot(gene.essential4,aes(pgr.quant2, color = Description,size = 1.2)) +
stat_ecdf(geom = "point") + theme_bw()
ggplot(gene.essential4,aes(pgr.quant2, color = Description,size = 1)) +
stat_ecdf(geom = "point") + theme_bw()
ggplot(gene.essential4,aes(pgr.quant2, color = Description,size = 0.5)) +
stat_ecdf(geom = "point") + theme_bw()
ggplot(gene.essential4,aes(pgr.quant2, color = Description)) +
stat_ecdf(geom = "point") + theme_bw()
ggplot(gene.essential4,aes(pgr.quant2, color = Description)) +  geom_point(aes(size = 2)) +
stat_ecdf(geom = "point") + theme_bw()
ggplot(gene.essential4,aes(pgr.quant2, color = Description)) +
stat_ecdf(geom = "point") + theme_bw()
ggplot(gene.essential4,aes(pgr.quant2, color = Description)) +
stat_ecdf(geom = "point", size =1) + theme_bw()
ggplot(gene.essential4,aes(pgr.quant2, color = Description)) +
stat_ecdf(geom = "point", size =2) + theme_bw()
ggplot(gene.essential4,aes(pgr.quant2, color = Description)) +
stat_ecdf(geom = "point", size =2) + theme_bw() +
theme(strip.text = element_text(face="bold", size=20),
plot.title = element_text(size = 20),
axis.title = element_text(size = 30),
legend.text = element_text(size = 9),
legend.title=element_text(face = "bold", size = 9),
axis.text.y=element_text(size = 15),
axis.text.x=element_text(size = 15),
axis.ticks.y=element_blank())
ggplot(gene.essential4,aes(pgr.quant2, color = Description)) +
stat_ecdf(geom = "point", size =2) + theme_bw() + labs(x = "Quantile", y = "Cumulative Density")+
theme(strip.text = element_text(face="bold", size=20),
plot.title = element_text(size = 20),
axis.title = element_text(size = 30),
legend.text = element_text(size = 9),
legend.title=element_text(face = "bold", size = 9),
axis.text.y=element_text(size = 15),
axis.text.x=element_text(size = 15),
axis.ticks.y=element_blank())
ggplot(gene.essential4,aes(pgr.quant2, color = Description)) +
stat_ecdf(geom = "point", size =2) + theme_bw() + labs(x = "Quantile", y = "Cumulative Density")+
theme(strip.text = element_text(face="bold", size=20),
plot.title = element_text(size = 20),
axis.title = element_text(size = 30),
legend.text = element_text(size = 9),
legend.title=element_text(face = "bold", size = 9),
axis.text.y=element_text(size = 20),
axis.text.x=element_text(size = 20),
axis.ticks.y=element_blank())
ggplot(gene.essential4,aes(pgr.quant2, color = Description)) +
stat_ecdf(geom = "point", size =2) + theme_bw() + labs(x = "Quantile", y = "Cumulative Density")+
theme(strip.text = element_text(face="bold", size=20),
plot.title = element_text(size = 20),
axis.title = element_text(size = 30),
legend.text = element_text(size = 20),
legend.title=element_text(face = "bold", size = 9),
axis.text.y=element_text(size = 20),
axis.text.x=element_text(size = 20),
axis.ticks.y=element_blank())
ggplot(gene.essential4,aes(pgr.quant2, color = Description)) +
stat_ecdf(geom = "point", size =2) + theme_bw() + labs(x = "Quantile", y = "Cumulative Density")+
theme(strip.text = element_text(face="bold", size=20),
plot.title = element_text(size = 20),
axis.title = element_text(size = 30),
legend.text = element_text(size = 20),
legend.title=element_text(face = "bold", size = 30),
axis.text.y=element_text(size = 20),
axis.text.x=element_text(size = 20),
axis.ticks.y=element_blank())
ggplot(gene.essential4,aes(pgr.quant2, color = Description)) +
stat_ecdf(geom = "point", size =2) + theme_bw() + labs(x = "Quantile", y = "Cumulative Density")+
theme(strip.text = element_text(face="bold", size=20),
plot.title = element_text(size = 20),
axis.title = element_text(size = 30),
legend.text = element_text(size = 20),
legend.title=element_text(face = "bold", size = 20),
axis.text.y=element_text(size = 20),
axis.text.x=element_text(size = 20),
axis.ticks.y=element_blank())
ggplot(gene.essential4,aes(pgr.quant2, color = Description)) +
stat_ecdf(geom = "point", size =2) + theme_bw() + labs(x = "Quantile", y = "Cumulative Density")+
theme(strip.text = element_text(face="bold", size=20),
plot.title = element_text(size = 20),
axis.title = element_text(size = 30),
legend.text = element_text(size = 20),
legend.title=element_text(face = "bold", size = 20),
axis.text.y=element_text(size = 20),
axis.text.x=element_text(size = 20),
axis.ticks.y=element_blank(),
legend.position="bottom", legend.box = "horizontal")
ggplot(gene.essential4,aes(pgr.quant2, color = Description)) +
stat_ecdf(geom = "point", size =2) + theme_bw() + labs(x = "Quantile", y = "Cumulative Density")+
theme(strip.text = element_text(face="bold", size=20),
plot.title = element_text(size = 20),
axis.title = element_text(size = 30),
legend.text = element_text(size = 20),
legend.title=element_blank(),
axis.text.y=element_text(size = 20),
axis.text.x=element_text(size = 20),
axis.ticks.y=element_blank(),
legend.position="bottom", legend.box = "horizontal")
ggplot(gene.essential4,aes(pgr.quant2, color = Description)) +
stat_ecdf(geom = "point", size =2) + theme_bw() + labs(x = "Quantile", y = "Cumulative Density")+
guides(colour = guide_legend(override.aes = list(size=10))) +
theme(strip.text = element_text(face="bold", size=20),
plot.title = element_text(size = 20),
axis.title = element_text(size = 30),
legend.text = element_text(size = 20),
legend.title=element_blank(),
axis.text.y=element_text(size = 20),
axis.text.x=element_text(size = 20),
axis.ticks.y=element_blank(),
legend.position="bottom", legend.box = "horizontal")
ggplot(gene.essential4,aes(pgr.quant2, color = Description)) +
stat_ecdf(geom = "point", size =2) + theme_bw() + labs(x = "Quantile", y = "Cumulative Density")+
guides(colour = guide_legend(override.aes = list(size=10))) +
theme(strip.text = element_text(face="bold", size=20),
plot.title = element_text(size = 20),
axis.title = element_text(size = 20),
legend.text = element_text(size = 20),
legend.title=element_blank(),
axis.text.y=element_text(size = 20),
axis.text.x=element_text(size = 20),
axis.ticks.y=element_blank(),
legend.position="bottom", legend.box = "horizontal")
ggplot(gene.essential4,aes(pgr.quant2, color = Description)) +
stat_ecdf(geom = "point", size =2) + theme_bw() + labs(x = "Quantile", y = "Cumulative Density")+
guides(colour = guide_legend(override.aes = list(size=10))) +
theme(strip.text = element_text(face="bold", size=20),
plot.title = element_text(size = 20),
axis.title = element_text(size = 25),
legend.text = element_text(size = 20),
legend.title=element_blank(),
axis.text.y=element_text(size = 20),
axis.text.x=element_text(size = 20),
axis.ticks.y=element_blank(),
legend.position="bottom", legend.box = "horizontal")
ggplot(gene.essential2,aes(pgr.quant2, color = Description)) +
stat_ecdf(geom = "point") + theme_bw()
ggplot(gene.essential2,aes(pgr.quant2, color = Description)) +
stat_ecdf(geom = "point") + theme_bw() + labs(x = "Quantile", y = "Cumulative Density")+
guides(colour = guide_legend(override.aes = list(size=10))) +
theme(strip.text = element_text(face="bold", size=20),
plot.title = element_text(size = 20),
axis.title = element_text(size = 25),
legend.text = element_text(size = 20),
legend.title=element_blank(),
axis.text.y=element_text(size = 20),
axis.text.x=element_text(size = 20),
axis.ticks.y=element_blank(),
legend.position="bottom", legend.box = "horizontal")
zzz0 <-  gene.essential %>%
dplyr::select(.,pgr.quant2) %>% unlist %>% unname %>% ecdf()
zzz1 <-  gene.essential %>% filter(., Description =="Normal") %>%
dplyr::select(.,pgr.quant2) %>% unlist %>% unname %>% ecdf()
zzz3 <-  gene.essential %>% filter(., Description =="Normal") %>%
dplyr::select(.,ssc.quant3) %>% unlist %>% ecdf()
zzz4 <-  gene.essential %>% filter(., Description =="Cancer") %>%
dplyr::select(.,ssc.quant3) %>% unlist %>% ecdf()
zzz3 <-  gene.essential %>% filter(., Description =="Normal") %>%
dplyr::select(.,pgr.quant3) %>% unlist %>% ecdf()
zzz4 <-  gene.essential %>% filter(., Description =="Cancer") %>%
dplyr::select(.,pgr.quant3) %>% unlist %>% ecdf()
ks.test(zzz0,zzz1)
zzz0 <-  gene.essential %>%
dplyr::select(.,pgr.quant2) %>% unlist %>% unname #%>% ecdf()
zzz1 <-  gene.essential %>% filter(., Description =="Normal") %>%
dplyr::select(.,pgr.quant2) %>% unlist %>% unname #%>% ecdf()
ks.test(zzz0,zzz1)
ks.test(zzz0,zzz1, alternative = "less")
ks.test(zzz0,zzz2, alternative = "less")
ks.test(zzz2,zzz0, alternative = "less")
zzz2<- gene.essential %>% filter(., Description =="Cancer") %>%
dplyr::select(.,pgr.quant2) %>% unlist %>% unname #%>% ecdf()
ks.test(zzz2,zzz0, alternative = "less")
ks.test(zzz2,zzz1, alternative = "less")
zzz3 <-  gene.essential %>% filter(., Description =="Normal") %>%
dplyr::select(.,pgr.quant3) %>% unlist  #%>% ecdf()
zzz4 <-  gene.essential %>% filter(., Description =="Cancer") %>%
dplyr::select(.,pgr.quant3) %>% unlist  #%>% ecdf()
ks.test(zzz2,zzz4, alternative = "greater")
ks.test(zzz4,zzz2, alternative = "greater")
gene.essential <-  all.homo.essential #%>% filter(.,IMPC_viability_DR7.0  == "Viable")
gene.essential <- gene.essential %>%  replace_na(list(Description = "Normal"))
gene.essential$Description
gene.essential %<>% filter(., total.node >20, total.edge > 20) %>%
mutate(., ssc.quant = round((ssc.rank/total.node)*100),
deg.quant = round((degree.rank/total.node)*100),
bet.quant = round((beet.rank/total.node)*100),
pgr.quant = round((pgr.rank/total.node)*100),
pgr.dbl.quant = round((pgr.dbl.rank/total.node)*100),
pgr.und.quant = round((pgr.und.rank/total.node)*100),
ktz.quant = round((ktz.rank/total.node)*100))
gene.essential %>% filter(., Description == "Cancer") %>% distinct(.,node.genes)
a <- gene.essential %>% group_by(ssc.quant, Description)  %>%
summarise(n = n()) %>% mutate(freq = n/ sum(n)) %>%
filter(., Description== "Cancer") %>%
mutate(., Centrality = "Katz-Source-Sink",quant = ssc.quant)
b <- gene.essential %>% group_by(deg.quant,Description)  %>%
summarise(n = n()) %>% mutate(freq = n/ sum(n)) %>%
filter(., Description== "Cancer") %>%
mutate(Centrality = "Degree",quant = deg.quant )
c <- gene.essential %>% group_by(bet.quant,Description)  %>%
summarise(n = n()) %>% mutate(freq = n/ sum(n)) %>%
filter(., Description== "Cancer") %>%
mutate(Centrality = "Betweenness" ,quant = bet.quant)
d <- gene.essential %>% group_by(pgr.quant,Description)  %>%
summarise(n = n()) %>% mutate(freq = n/ sum(n)) %>%
filter(., Description== "Cancer") %>%
mutate(Centrality = "PageRank",quant = pgr.quant)
e <- gene.essential %>% group_by(ktz.quant,Description)  %>%
summarise(n = n()) %>% mutate(freq = n/ sum(n)) %>%
filter(., Description== "Cancer")  %>%
mutate(Centrality = "Katz",quant = ktz.quant)
f <- gene.essential %>% group_by(pgr.dbl.quant,Description)  %>%
summarise(n = n()) %>% mutate(freq = n/ sum(n)) %>%
filter(., Description== "Cancer")  %>%
mutate(Centrality = "PageRank-Source-Sink",quant = pgr.dbl.quant )
g <- gene.essential %>% group_by(pgr.und.quant,Description)  %>%
summarise(n = n()) %>% mutate(freq = n/ sum(n)) %>%
filter(., Description== "Cancer")  %>%
mutate(Centrality = "PageRank-Undirected",quant = pgr.und.quant )
total <- rbind(a,b,d,e,f,g)
ggplot(total, aes(y = freq, x= quant)) + geom_point()+
geom_smooth(method= "lm") + geom_smooth(method= "loess", color="green" , fill = "red") +
facet_wrap(~Centrality ,ncol = 3) +theme_bw()+ labs(x = "Quantile", y = "Frequency")+
theme(strip.text = element_text(face="bold", size=20),
plot.title = element_text(size = 20),
axis.title = element_text(size = 30),
legend.text = element_text(size = 9),
legend.title=element_text(face = "bold", size = 9),
axis.text.y=element_text(size = 15),
axis.text.x=element_text(size = 15),
axis.ticks.y=element_blank())
ggplot(total, aes(y = freq, x= quant)) + geom_point()+
geom_smooth(method= "lm") + #geom_smooth(method= "loess", color="green" , fill = "red") +
facet_wrap(~Centrality ,ncol = 3) +theme_bw()+ labs(x = "Quantile", y = "Frequency")+
theme(strip.text = element_text(face="bold", size=20),
plot.title = element_text(size = 20),
axis.title = element_text(size = 30),
legend.text = element_text(size = 9),
legend.title=element_text(face = "bold", size = 9),
axis.text.y=element_text(size = 15),
axis.text.x=element_text(size = 15),
axis.ticks.y=element_blank())
total %>% group_by(Centrality) %>%
do(fit = lm(freq ~ as.numeric(quant), data=.)) %>%  glance(fit)
total %>% group_by(Centrality) %>% summarise(.,cor.test(freq,as.numeric(quant))$estimate)
overall.cors <- total %>% group_by(Centrality) %>%
do(fit = lm(freq ~ as.numeric(quant), data=.)) %>%  glance(fit)
library(xtable)
xtable(overall.cors)
overall.cors
xtable(overall.cors[c(1,2,3,6),])
xtable(overall.cors[,c(1,2,3,6)])
print(xtable(overall.cors[,c(1,2,3,6)],), include.rownames = F)
overall.cors <- overall.cors[,c(1,2,3,6)]
formatC(overall.cors[,4], format = "e", digits = 2)
formatC(as.numeric(overall.cors[,4]), format = "e", digits = 2)
formatC(unlist(as.numeric(overall.cors[,4])), format = "e", digits = 2)
as.numeric(overall.cors[,4])
overall.cors[,4]
overall.cors %>% formatC(.$p.value, format = "e", digits = 2)
formatC(unlist(pull(overall.cors[,4])), format = "e", digits = 2)
overall.cors[,4] <- formatC(unlist(pull(overall.cors[,4])), format = "e", digits = 2)
overall.cors
print(xtable(overall.cors[,c(1,2,3,6)]), include.rownames = F)
print(xtable(overall.cors), include.rownames = F)
zzz0 <-  gene.essential %>%
dplyr::select(.,ssc.quant2) %>% unlist %>% unname #%>% ecdf()
zzz1 <-  gene.essential %>% filter(., Description =="Normal") %>%
dplyr::select(.,ssc.quant2) %>% unlist %>% unname #%>% ecdf()
zzz2<- gene.essential %>% filter(., Description =="Cancer") %>%
dplyr::select(.,ssc.quant2) %>% unlist %>% unname #%>% ecdf()
zz2 <- cut2(gene.essential$cent.vec,m = 3, g = 100)
levels(zz2) <- 1:100
zz2
gene.essential <-  mutate(gene.essential, ssc.quant2 = as.numeric(zz2))
zzz0 <-  gene.essential %>%
dplyr::select(.,ssc.quant2) %>% unlist %>% unname #%>% ecdf()
zzz1 <-  gene.essential %>% filter(., Description =="Normal") %>%
dplyr::select(.,ssc.quant2) %>% unlist %>% unname #%>% ecdf()
zzz2<- gene.essential %>% filter(., Description =="Cancer") %>%
dplyr::select(.,ssc.quant2) %>% unlist %>% unname #%>% ecdf()
gene.essential <-  all.homo.essential #%>% filter(.,IMPC_viability_DR7.0  == "Viable")
gene.essential <- gene.essential %>%  replace_na(list(Description = "Normal"))
gene.essential$Description
gene.essential %<>% filter(., total.node >20, total.edge > 20) %>%
mutate(., ssc.quant = round((ssc.rank/total.node)*100),
deg.quant = round((degree.rank/total.node)*100),
bet.quant = round((beet.rank/total.node)*100),
pgr.quant = round((pgr.rank/total.node)*100),
pgr.dbl.quant = round((pgr.dbl.rank/total.node)*100),
pgr.und.quant = round((pgr.und.rank/total.node)*100),
ktz.quant = round((ktz.rank/total.node)*100))
gene.essential %>% filter(., Description == "Cancer") %>% distinct(.,node.genes)
zz <- cut2(gene.essential$pgr.dbl.norm,m = 3, g = 100)
levels(zz) <- 1:100
zz2 <- cut2(gene.essential$cent.vec,m = 3, g = 100)
levels(zz2) <- 1:100
zz3 <- cut2(gene.essential$pgr.und.norm,m = 3, g = 101)
levels(zz3) <- 1:100
gene.essential <-  mutate(gene.essential, pgr.quant2 = as.numeric(zz))
gene.essential <-  mutate(gene.essential, ssc.quant2 = as.numeric(zz2))
gene.essential <-  mutate(gene.essential, pgr.quant3 = as.numeric(zz3))
zzz0 <-  gene.essential %>%
dplyr::select(.,ssc.quant2) %>% unlist %>% unname #%>% ecdf()
zzz1 <-  gene.essential %>% filter(., Description =="Normal") %>%
dplyr::select(.,ssc.quant2) %>% unlist %>% unname #%>% ecdf()
zzz2<- gene.essential %>% filter(., Description =="Cancer") %>%
dplyr::select(.,ssc.quant2) %>% unlist %>% unname #%>% ecdf()
gene.essential2 <- rbind(gene.essential, mutate(gene.essential, Description = "All genes"))
ggplot(gene.essential2,aes(ssc.quant2, color = Description)) +
stat_ecdf(geom = "point") + theme_bw() + labs(x = "Quantile", y = "Cumulative Density")+
guides(colour = guide_legend(override.aes = list(size=10))) +
theme(strip.text = element_text(face="bold", size=20),
plot.title = element_text(size = 20),
axis.title = element_text(size = 25),
legend.text = element_text(size = 20),
legend.title=element_blank(),
axis.text.y=element_text(size = 20),
axis.text.x=element_text(size = 20),
axis.ticks.y=element_blank(),
legend.position="bottom", legend.box = "horizontal")
ggplot(gene.essential2,aes(all.degree, color = Description)) +
stat_ecdf(geom = "point") + theme_bw() + labs(x = "Quantile", y = "Cumulative Density")+
guides(colour = guide_legend(override.aes = list(size=10))) +
theme(strip.text = element_text(face="bold", size=20),
plot.title = element_text(size = 20),
axis.title = element_text(size = 25),
legend.text = element_text(size = 20),
legend.title=element_blank(),
axis.text.y=element_text(size = 20),
axis.text.x=element_text(size = 20),
axis.ticks.y=element_blank(),
legend.position="bottom", legend.box = "horizontal")
rm(list = ls())
